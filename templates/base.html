<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>{% block title %}CraftGhana{% endblock %}</title>

  <!-- Bootstrap CSS -->
  <link 
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" 
    rel="stylesheet">

  <!-- Custom CSS -->
  <link 
    rel="stylesheet" 
    href="{{ url_for('static', filename='style.css') }}">

  <!-- Google Fonts -->
  <link 
    href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" 
    rel="stylesheet">

  <!-- Favicon -->
  <link 
    rel="icon" 
    href="{{ url_for('static', filename='images/favicon.png') }}" 
    type="image/png">
</head>

<body class="{% if request.endpoint == 'login' %}login-page
             {% elif request.endpoint == 'register' %}register-page
             {% elif request.endpoint == 'browse' %}browse-page
             {% elif request.endpoint == 'cart' %}cart-page
             {% elif request.endpoint == 'home' %}home-page
             {% elif request.endpoint == 'artisan_dashboard' %}artisan-dashboard-page
             {% else %}default-page{% endif %}">

  <!-- ğŸŒ Navbar -->
  <nav 
    class="navbar navbar-expand-lg shadow-sm sticky-top 
    {% if request.endpoint in ['login', 'register'] %}navbar-transparent{% else %}navbar-dark bg-dark{% endif %}">
    <div class="container">
      <a class="navbar-brand fw-bold text-warning" href="{{ url_for('home') }}">CraftGhana</a>

      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav ms-auto align-items-center">
          <li class="nav-item"><a class="nav-link" href="{{ url_for('browse') }}">Browse</a></li>
          <li class="nav-item"><a class="nav-link" href="{{ url_for('about') }}">About</a></li>

          {% if current_user.is_authenticated %}
            <li class="nav-item">
              <a class="nav-link" href="{% if current_user.role == 'customer' %}{{ url_for('my_orders') }}
                {% elif current_user.role == 'artisan' %}{{ url_for('artisan_dashboard') }}
                {% else %}{{ url_for('admin') }}{% endif %}">
                Dashboard
              </a>
            </li>
            <li class="nav-item"><a class="nav-link" href="{{ url_for('logout') }}">Logout</a></li>
            <li class="nav-item"><span class="nav-link text-warning">Hi, {{ current_user.full_name.split(' ')[0] }}</span></li>
          {% else %}
            <li class="nav-item"><a class="nav-link" href="{{ url_for('login') }}">Login</a></li>
            <li class="nav-item"><a class="nav-link" href="{{ url_for('register') }}">Register</a></li>
          {% endif %}

          <li class="nav-item">
            <a class="btn btn-warning btn-sm ms-2" href="{{ url_for('cart') }}">ğŸ›’ Cart</a>
          </li>

          <!-- Theme Toggle -->
          <li class="nav-item ms-2">
            <button id="themeToggle" class="btn btn-outline-light btn-sm">ğŸŒ™</button>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- ğŸ–¼ï¸ Hero Section -->
  {% block hero %}{% endblock %}

  <!-- ğŸ’¬ Flash Messages -->
  <div class="container mt-3">
    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        {% for category, message in messages %}
          <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
            {{ message }}
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
          </div>
        {% endfor %}
      {% endif %}
    {% endwith %}
  </div>

  <!-- ğŸ§© Main Page Content -->
  <main>
    {% block content %}{% endblock %}
  </main>

  <!-- âš™ï¸ Footer -->
  <footer 
    class="text-white text-center p-4 mt-5 
    {% if request.endpoint in ['login', 'register'] %}footer-transparent{% else %}bg-dark{% endif %}">
    <div class="container">
      <p class="mb-1">&copy; {{ now.year }} CraftGhana. All rights reserved.</p>
      <p class="mb-0">
        <a href="#" class="text-warning text-decoration-none">Privacy Policy</a> |
        <a href="#" class="text-warning text-decoration-none">Terms of Service</a>
      </p>
    </div>
  </footer>

  <!-- ğŸš€ Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

  <!-- ğŸŒ— Theme Toggle Script -->
  <script>
    const toggleBtn = document.getElementById("themeToggle");
    const currentTheme = localStorage.getItem("theme") || "light";
    document.body.classList.toggle("dark-mode", currentTheme === "dark");
    toggleBtn.textContent = currentTheme === "dark" ? "â˜€ï¸" : "ğŸŒ™";

    toggleBtn.addEventListener("click", () => {
      const isDark = document.body.classList.toggle("dark-mode");
      localStorage.setItem("theme", isDark ? "dark" : "light");
      toggleBtn.textContent = isDark ? "â˜€ï¸" : "ğŸŒ™";
    });
  </script>

  <!-- âœ¨ Scroll Animation -->
  <script>
    document.addEventListener("scroll", () => {
      document.querySelectorAll(".fade-section").forEach(section => {
        const rect = section.getBoundingClientRect();
        if (rect.top < window.innerHeight - 100) {
          section.classList.add("visible");
        }
      });
    });
  </script>

</body>
</html>
